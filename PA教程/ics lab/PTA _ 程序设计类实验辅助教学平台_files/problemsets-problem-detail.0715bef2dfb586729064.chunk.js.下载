(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1073:function(e,t,n){"use strict";n.d(t,"a",function(){return w});var r=n(16),o=n.n(r),a=n(20),l=n.n(a),i=n(17),s=n.n(i),m=n(18),p=n.n(m),c=n(19),u=n.n(c),b=n(8),d=n.n(b),f=n(2),h=n.n(f),S=n(1),y=n.n(S),v=n(0),P=n.n(v),g=n(45),E=function(e){return e.dirty&&!e.submitSucceeded},O="Changes may not be saved. Are you sure you want to leave?";function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;return function(t){var n,r;return Object(g.f)((r=n=function(n){function r(){var e,t;o()(this,r);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return t=s()(this,(e=p()(r)).call.apply(e,[this].concat(a))),h()(d()(d()(t)),"shouldConfirm",!1),h()(d()(d()(t)),"confirmHandle",function(e){var n=t.shouldConfirm?t.props.t("common.confirm-leave"):void 0;n&&((e||window.event).returnValue=n);return n}),t}return u()(r,n),l()(r,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.router,r=t.routes;window.addEventListener("beforeunload",this.confirmHandle),n.setRouteLeaveHook(r[r.length-1],function(){return e.shouldConfirm?e.props.t("common.confirm-leave"):null})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.confirmHandle)}},{key:"render",value:function(){return this.shouldConfirm=e(this.props),y.a.createElement(t,this.props)}}]),r}(y.a.Component),h()(n,"displayName","ConfirmLeave(".concat(t.displayName||t.name,")")),h()(n,"propTypes",{t:P.a.func,router:P.a.shape().isRequired,routes:P.a.arrayOf(P.a.shape()).isRequired}),h()(n,"defaultProps",{t:function(){return O}}),r))}}},1431:function(e,t,n){var r=n(1432);"string"==typeof r&&(r=[[e.i,r,""]]);n(44)(r,{});r.locals&&(e.exports=r.locals)},1432:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,".code_ew3El {\n  font-family: monospace;\n}\n",""]),t.locals={code:"code_ew3El"}},1504:function(e,t,n){"use strict";n.r(t);var r,o,a,l,i,s,m=n(16),p=n.n(m),c=n(20),u=n.n(c),b=n(17),d=n.n(b),f=n(18),h=n.n(f),S=n(19),y=n.n(S),v=n(8),P=n.n(v),g=n(2),E=n.n(g),O=n(6),w=n(1),C=n.n(w),k=n(0),x=n.n(k),I=n(26),j=n(38),R=n(11),M=n(172),B=n.n(M),T=n(24),q=n(14),N=n(37),A=n(70),L=n(106),_=n(23),F=n(7),D=n(1094),G=n(4),V=n.n(G),z=n(1064),H=n.n(z),U=n(91),W=n.n(U),J=n(1067),K=n.n(J),Q=n(112),X=n(480),Y=n(481),Z=n(107),$=n(55),ee=n(48),te=n(987),ne=n(989),re=n(1059),oe=n(131),ae=n(5),le=n(1003),ie=n(28),se=n(171),me=n(1073),pe=n(996),ce=n(1431),ue=n.n(ce),be=Object(Q.a)("problemSubmission"),de=Object(j.b)("all",{wait:!0})(r=Object(I.b)(Object(ie.k)(function(e,t){var n=t.problemSetProblem;if(!n)return{};var r=n.lastSubmissionDetail,o=Object(le.g)(n.type),a=t.compilers||[],l=Object(ie.b)().lastCompiler,i=r&&r["".concat(o,"SubmissionDetail")].compiler||a.includes(l)&&l||a[0],s=r?r["".concat(o,"SubmissionDetail")].program:"",m=be(e,"compiler")||i||L.a.NO_COMPILER.name;Object(ie.m)({lastCompiler:m});var p=r?r["".concat(o,"SubmissionDetail")].answer:"";return{compilerValue:m,lastFile:r&&r["".concat(o,"SubmissionDetail")].file||null,initialValues:{answer:p,compiler:i,program:s}}}))(r=Object(X.a)({form:"problemSubmission"})(r=Object(me.a)()(r=Object(pe.a)()((a=o=function(e){function t(){var e,n;p()(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=d()(this,(e=h()(t)).call.apply(e,[this].concat(o))),E()(P()(P()(n)),"state",{file:null}),E()(P()(P()(n)),"onBack",function(e){n.props.onBack(),e.preventDefault()}),E()(P()(P()(n)),"onFileChange",function(e){return n.setState({file:e.target.files[0]})}),E()(P()(P()(n)),"submit",function(){var e=K()(H.a.mark(function e(t){var r,o,a,l;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},n.props.problemSetProblem.type===_.m.SUBJECTIVE.name){e.next=6;break}n.props.compilers&&n.props.compilers.findIndex(function(e){return e===t.compiler})>=0?r.compiler=t.compiler:(o=W()(n.props.compilers,1),r.compiler=o[0]),r.program=t.program,e.next=16;break;case 6:if(r.answer=t.answer,!n.state.file){e.next=15;break}return e.next=10,ae.b.uploadFile(n.state.file);case 10:a=e.sent,l=a.path,r.file=l,e.next=16;break;case 15:n.props.lastFile&&(r.file=n.props.lastFile);case 16:return e.abrupt("return",n.props.onSubmit({problemType:n.props.problemSetProblem.type,details:[E()({problemSetProblemId:n.props.problemSetProblem.id},"".concat(n.camelCaseProblemType,"SubmissionDetail"),r)]}));case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),n}return y()(t,e),u()(t,[{key:"render",value:function(){var e=this.props,t=e.compilers,n=e.compilerValue,r=e.lastFile,o=e.onBack,a=e.permission,l=e.problemSetProblem,i=e.submitting,s=e.t,m=e.user;if(!l)return C.a.createElement("div",null);var p=l.type===_.m.SUBJECTIVE.name;return C.a.createElement(R.s,{onSubmit:this.props.handleSubmit(this.submit)},!!t&&!!t.length&&C.a.createElement(Y.a,{component:ne.a,name:"compiler",type:"select",inputCol:4,label:"".concat(s("common.compiler"),":").concat(s("common.compiler-available-count",{count:t.length})),disabled:t.length<=1},t.filter(function(e){return e!==L.a.NO_COMPILER.name}).map(function(e){return C.a.createElement("option",{key:e,value:e},s("compiler.".concat(e)))})),!!t&&!!t.length,p&&l.problemConfig.subjectiveProblemConfig.allowFileUpload&&C.a.createElement(R.u,null,r&&C.a.createElement("span",null,C.a.createElement("a",{href:"/api/submissions/".concat(l.lastSubmissionId,"/subjective-file"),rel:"noopener noreferrer",target:"_blank"},C.a.createElement(R.e,{color:"primary",size:"sm",type:"button"},s("subjective-judger.download-last-file")))," "),C.a.createElement("input",{name:"file",type:"file",onChange:this.onFileChange})),p?C.a.createElement(Y.a,{name:"answer",type:"textarea",rows:25,component:ne.a,fontSize:"14px"}):C.a.createElement(Y.a,{name:"program",type:"textarea",rows:25,component:re.a,compiler:n,focus:!0,fontSize:"14px",enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,label:s("common.program-code"),className:ue.a.code}),C.a.createElement(te.a,null,C.a.createElement(R.e,{color:"primary",disabled:!Object(se.b)(a,$.c.SUBMIT_PROBLEMS)||i,title:m.isGuest?s("common.need-login"):""},i&&C.a.createElement(oe.a,null),s("common.submit")),o&&C.a.createElement(R.e,{onClick:this.onBack},s("common.back"))))}},{key:"camelCaseProblemType",get:function(){return Object(le.g)(this.props.problemSetProblem.type)}}]),t}(C.a.Component),E()(o,"propTypes",V()({},Z.a,{compilers:x.a.arrayOf(L.b),lastFile:x.a.string,permission:$.e,problemSetProblem:A.b.isRequired,user:ee.a.isRequired,onSubmit:x.a.func.isRequired,onBack:x.a.func})),E()(o,"defaultProps",{compilers:null,lastFile:null,onBack:null,permission:$.d.NO_PERMISSION.binary}),r=a))||r)||r)||r)||r)||r,fe=n(988),he=n(56),Se=n(1119),ye=n.n(Se),ve=n(1178),Pe=n(268),ge=n(113);function Ee(){q.a.dispatch(Object(T.goBack)())}n.d(t,"default",function(){return we});var Oe={loadExamProblemStatus:N.c,loadProblemSetProblem:N.d,submitProblems:N.k},we=Object(j.b)("all",{wait:!0})(l=Object(I.b)(function(e,t){var n=Object(O.a)(t.params.id,F.ProblemSet,e.entity),r=Object(O.a)(t.params.problemSetProblemId,F.ProblemSetProblem,e.entity),o=!!r&&!!r.authorOrganization;return{problemSet:n||null,problemSetProblem:o?r:null}},Oe)((s=i=function(e){function t(){var e,n;p()(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=d()(this,(e=h()(t)).call.apply(e,[this].concat(o))),E()(P()(P()(n)),"toggleProblemSetSubmissionModal",Object(he.e)(P()(P()(n)),"isProblemSetSubmissionModalOpen")),E()(P()(P()(n)),"state",{isProblemSetSubmissionModalOpen:!1,lastSubmissionId:null}),E()(P()(P()(n)),"loadProblemSetProblem",function(e,t){n.props.loadProblemSetProblem(e,t,{exam_id:n.props.exam&&n.props.exam.id})}),E()(P()(P()(n)),"submitProblem",function(e){return n.props.submitProblems(n.props.params.id,n.props.exam.id,e).then(function(e){var t=e.action;n.props.loadExamProblemStatus(n.props.exam.id),t.payload.problemType!==_.m.PROGRAMMING.name&&t.payload.problemType!==_.m.CODE_COMPLETION.name||n.setState({isProblemSetSubmissionModalOpen:!0,lastSubmissionId:t.payload.submissionId})})}),n}return y()(t,e),u()(t,[{key:"componentDidMount",value:function(){this.props.params.problemSetProblemId&&this.loadProblemSetProblem(this.props.params.id,this.props.params.problemSetProblemId)}},{key:"componentWillReceiveProps",value:function(e){e.params!==this.props.params&&e.params.problemSetProblemId&&this.loadProblemSetProblem(e.params.id,e.params.problemSetProblemId)}},{key:"render",value:function(){var e,t=this.props,n=t.exam,r=t.problemSet,o=t.problemSetProblem,a=t.t;return o?(o.compiler&&o.compiler!==L.a.NO_COMPILER.name?e=[o.compiler]:o.type===_.m.PROGRAMMING.name&&(e=r&&r.problemSetConfig.compilers),C.a.createElement("div",null,C.a.createElement(R.k,null,o.label," ",o.title," ",!Object(ge.b)(r)&&"（".concat(o.score," ").concat(a("common.points"),"）")),C.a.createElement("div",{className:ye.a.problemListItem},C.a.createElement(Pe.a,{className:ye.a.problem,content:B.a.setScores(o.content,o.score)}),C.a.createElement(ve.a,{problem:o})),C.a.createElement("hr",null),C.a.createElement(de,{compilers:e,key:o.id,permission:n.permission,problemSetProblem:o,onSubmit:this.submitProblem,onBack:Ee}),C.a.createElement(D.a,{isOpen:this.state.isProblemSetSubmissionModalOpen,problemSetId:r.id,submissionId:this.state.lastSubmissionId,toggle:this.toggleProblemSetSubmissionModal,exam:n,shouldHideScore:Object(ge.b)(r)}))):C.a.createElement(fe.a,null)}},{key:"problemType",get:function(){return Object(le.g)(this.props.problemSetProblem.type)}}]),t}(C.a.Component),E()(i,"propTypes",{params:x.a.shape({id:x.a.string,problemSetProblemId:x.a.string}).isRequired,exam:A.d,problemSet:A.c,problemSetProblem:A.b,loadExamProblemStatus:x.a.func.isRequired,loadProblemSetProblem:x.a.func.isRequired,submitProblems:x.a.func.isRequired,t:x.a.func.isRequired}),E()(i,"defaultProps",{exam:null,problemSet:null,problemSetProblem:null}),l=s))||l)||l},987:function(e,t,n){"use strict";var r=n(1),o=n.n(r),a=n(0),l=n.n(a),i=n(990),s=n.n(i),m=function(e){return o.a.createElement("div",{className:s.a.buttonGroup},e.children)};m.propTypes={children:l.a.node.isRequired},t.a=m},989:function(e,t,n){"use strict";n.d(t,"a",function(){return I});var r=n(47),o=n.n(r),a=n(35),l=n.n(a),i=n(91),s=n.n(i),m=n(16),p=n.n(m),c=n(20),u=n.n(c),b=n(17),d=n.n(b),f=n(18),h=n.n(f),S=n(19),y=n.n(S),v=n(8),P=n.n(v),g=n(2),E=n.n(g),O=n(1),w=n.n(O),C=n(0),k=n.n(C),x=n(11),I=function(e){function t(){var e,n;p()(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return n=d()(this,(e=h()(t)).call.apply(e,[this].concat(o))),E()(P()(P()(n)),"getFeedback",function(){return n.props.meta.touched?n.props.meta.error?["danger",n.props.meta.error]:n.props.meta.warning?["warning",n.props.meta.warning]:["",""]:["",""]}),n}return y()(t,e),u()(t,[{key:"render",value:function(){var e=this.getFeedback(),t=s()(e,2),n=t[0],r=t[1],a=this.props,i=a.addonBefore,m=a.addonAfter,p=a.label,c=a.labelCol,u=a.inputCol,b=a.required,d=a.input,f=(a.meta,l()(a,["addonBefore","addonAfter","label","labelCol","inputCol","required","input","meta"])),h=i||m?w.a.createElement(x.w,null,!!i&&w.a.createElement(x.x,{addonType:"prepend"},"string"==typeof i?i:w.a.createElement(x.y,null,i)),w.a.createElement(x.v,o()({invalid:"danger"===n},d,f)),!!m&&w.a.createElement(x.x,{addonType:"append"},"string"==typeof i?m:w.a.createElement(x.y,null,m))):w.a.createElement(x.v,o()({},d,f)),S=p?w.a.createElement(x.L,null,w.a.createElement(x.l,{xs:c},b?w.a.createElement(x.z,{className:"required"},p):w.a.createElement(x.z,null,p)),w.a.createElement(x.l,{xs:u},h)):h;return w.a.createElement(x.u,null,S,r&&w.a.createElement(x.t,{style:{color:"warning"===n?"#666":void 0}},w.a.createElement(x.L,null,w.a.createElement(x.l,{xs:p?{size:u,offset:c}:{size:12}},r))))}}]),t}(w.a.Component);E()(I,"propTypes",{meta:k.a.shape(),input:k.a.shape(),label:k.a.node,addonBefore:k.a.node,addonAfter:k.a.node,labelCol:k.a.number,inputCol:k.a.number,required:k.a.bool}),E()(I,"defaultProps",{meta:{},input:{},label:"",addonAfter:"",addonBefore:"",labelCol:2,inputCol:10,required:!1})},990:function(e,t,n){var r=n(991);"string"==typeof r&&(r=[[e.i,r,""]]);n(44)(r,{});r.locals&&(e.exports=r.locals)},991:function(e,t,n){(t=e.exports=n(43)(!1)).push([e.i,".buttonGroup_3VuWy {\n  text-align: center;\n  margin-bottom: 1rem\n}\n.buttonGroup_3VuWy button {\n    padding: 0.5rem 1rem;\n    margin: 0 0.5rem;\n  }\n",""]),t.locals={buttonGroup:"buttonGroup_3VuWy"}}}]);